//go:build !ignore_autogenerated
// +build !ignore_autogenerated

// Code generated by diegen. DO NOT EDIT.

package v1alpha1

import (
	v1 "dies.dev/apis/meta/v1"
	"encoding/json"
	fmtx "fmt"
	"k8s.io/apimachinery/pkg/apis/meta/v1/unstructured"
	"k8s.io/apimachinery/pkg/runtime"
	"k8s.io/apimachinery/pkg/runtime/schema"
)

var ClusterRunTemplateBlank = (&ClusterRunTemplateDie{}).DieFeed(ClusterRunTemplate{})

type ClusterRunTemplateDie struct {
	v1.FrozenObjectMeta
	mutable bool
	r       ClusterRunTemplate
}

// DieImmutable returns a new die for the current die's state that is either mutable (`false`) or immutable (`true`).
func (d *ClusterRunTemplateDie) DieImmutable(immutable bool) *ClusterRunTemplateDie {
	if d.mutable == !immutable {
		return d
	}
	d = d.DeepCopy()
	d.mutable = !immutable
	return d
}

// DieFeed returns a new die with the provided resource.
func (d *ClusterRunTemplateDie) DieFeed(r ClusterRunTemplate) *ClusterRunTemplateDie {
	if d.mutable {
		d.FrozenObjectMeta = v1.FreezeObjectMeta(r.ObjectMeta)
		d.r = r
		return d
	}
	return &ClusterRunTemplateDie{
		FrozenObjectMeta: v1.FreezeObjectMeta(r.ObjectMeta),
		mutable:          d.mutable,
		r:                r,
	}
}

// DieFeedPtr returns a new die with the provided resource pointer. If the resource is nil, the empty value is used instead.
func (d *ClusterRunTemplateDie) DieFeedPtr(r *ClusterRunTemplate) *ClusterRunTemplateDie {
	if r == nil {
		r = &ClusterRunTemplate{}
	}
	return d.DieFeed(*r)
}

// DieRelease returns the resource managed by the die.
func (d *ClusterRunTemplateDie) DieRelease() ClusterRunTemplate {
	if d.mutable {
		return d.r
	}
	return *d.r.DeepCopy()
}

// DieReleasePtr returns a pointer to the resource managed by the die.
func (d *ClusterRunTemplateDie) DieReleasePtr() *ClusterRunTemplate {
	r := d.DieRelease()
	return &r
}

// DieReleaseUnstructured returns the resource managed by the die as an unstructured object.
func (d *ClusterRunTemplateDie) DieReleaseUnstructured() runtime.Unstructured {
	r := d.DieReleasePtr()
	u, _ := runtime.DefaultUnstructuredConverter.ToUnstructured(r)
	return &unstructured.Unstructured{
		Object: u,
	}
}

// DieStamp returns a new die with the resource passed to the callback function. The resource is mutable.
func (d *ClusterRunTemplateDie) DieStamp(fn func(r *ClusterRunTemplate)) *ClusterRunTemplateDie {
	r := d.DieRelease()
	fn(&r)
	return d.DieFeed(r)
}

// DeepCopy returns a new die with equivalent state. Useful for snapshotting a mutable die.
func (d *ClusterRunTemplateDie) DeepCopy() *ClusterRunTemplateDie {
	r := *d.r.DeepCopy()
	return &ClusterRunTemplateDie{
		FrozenObjectMeta: v1.FreezeObjectMeta(r.ObjectMeta),
		mutable:          d.mutable,
		r:                r,
	}
}

var _ runtime.Object = (*ClusterRunTemplateDie)(nil)

func (d *ClusterRunTemplateDie) DeepCopyObject() runtime.Object {
	return d.r.DeepCopy()
}

func (d *ClusterRunTemplateDie) GetObjectKind() schema.ObjectKind {
	r := d.DieRelease()
	return r.GetObjectKind()
}

func (d *ClusterRunTemplateDie) MarshalJSON() ([]byte, error) {
	return json.Marshal(d.r)
}

func (d *ClusterRunTemplateDie) UnmarshalJSON(b []byte) error {
	if d == ClusterRunTemplateBlank {
		return fmtx.Errorf("cannot unmarshal into the blank die, create a copy first")
	}
	if !d.mutable {
		return fmtx.Errorf("cannot unmarshal into immutable dies, create a mutable version first")
	}
	r := &ClusterRunTemplate{}
	err := json.Unmarshal(b, r)
	*d = *d.DieFeed(*r)
	return err
}

// MetadataDie stamps the resource's ObjectMeta field with a mutable die.
func (d *ClusterRunTemplateDie) MetadataDie(fn func(d *v1.ObjectMetaDie)) *ClusterRunTemplateDie {
	return d.DieStamp(func(r *ClusterRunTemplate) {
		d := v1.ObjectMetaBlank.DieImmutable(false).DieFeed(r.ObjectMeta)
		fn(d)
		r.ObjectMeta = d.DieRelease()
	})
}

// Spec describes the run template. More info: https://cartographer.sh/docs/latest/reference/runnable/#clusterruntemplate
func (d *ClusterRunTemplateDie) Spec(v RunTemplateSpec) *ClusterRunTemplateDie {
	return d.DieStamp(func(r *ClusterRunTemplate) {
		r.Spec = v
	})
}
